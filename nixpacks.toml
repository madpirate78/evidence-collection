# Use Bun for package management
providers = ["node"]

[variables]
NIXPACKS_PATH = "/app/node_modules/.bin"

[phases.setup]
nixPkgs = ["bun", "nodejs_20"]

[phases.install]
cmds = ["bun install --frozen-lockfile"]

[phases.build]
cmds = ["bun run build", "cp -r public .next/standalone/", "cp -r .next/static .next/standalone/.next/"]

[start]
cmd = "PORT=${PORT:-3000} HOSTNAME=0.0.0.0 node .next/standalone/server.js"
